name: Weekly Release

on:
  schedule:
    - cron:  '12 0 * * WED'

        
jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Get current date
        id: date
        run: echo "::set-output name=date::$(date +'%s')"
      - name: Get weekly release number
        id: weekly
        run: echo "::set-output name=weekly::$(expr ${{ steps.date.outputs.date }} / 86400 / 7 - 2697)"
      - uses: ncipollo/release-action@v1
        with:
          tag: v1.${{ steps.weekly.outputs.weekly }}.0
          token: ${{ secrets.GITHUB_TOKEN }}